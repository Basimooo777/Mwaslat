<body id="bodyId" onload="editRoutes();prepare_form()">
	<div id="map_canvas" style="width:100%; height:100%"></div>
	<p>
		<%= notice %>
	</p>
	<%= form_for @route do |f_route| %>
		<div id="sub_routes">
				<%= f_route.fields_for :sub_routes do |f_sub_routes|%>
						<%= render "sub_route_fields", :f => f_sub_routes %>
				<%end%>
				<br/>
		</div>
		<hr width="50%" align="left"/>
		<table>
			<tr>
			<%= f_route.fields_for :transportation  do |f_trans| %>
				<td><%= f_trans.label :category, "Transportation" %></td>
				<td><%= f_trans.text_field :category %></td>
			<% end %>
			</tr>
			<tr>
				<td><%= f_route.label :cost, "Cost" %></td>
				<td><%= f_route.text_field :cost %></td>
			</tr>
		</table>
		<%javascript_tag do%>
			window.sub_route_element = <%= get_stop(f_route)%>;
		<%end%>
		<%= f_route.submit() %><br/>
	<% end %>
	<br/>
</body>
	<%= javascript_tag do %>
		window.updatable_stops = <%=raw @route.sub_routes.to_json(
		:include => {
			:dest => {:only =>[:path, :name]}
		},
		:only => {} ) %>;
	<% end %>
	<%= javascript_tag do %>
		window.nodes = <%=raw Node.all.to_json(:only => [:name, :path, :id] ) %>;
	<% end %>
